"use strict";

/*
 * MikoPBX - free phone system for small business
 * Copyright Â© 2017-2023 Alexey Portnov and Nikolay Beketov
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see <https://www.gnu.org/licenses/>.
 */

/* global globalRootUrl, globalTranslate, Form, PbxApi*/
var moduleUsersUiIndexLdap = {
  /**
   * Checkbox for LDAP authentication.
   * @type {jQuery}
   * @private
   */
  $useLdapCheckbox: $('#use-ldap-auth-method'),

  /**
   * Set of form fields to use for LDAP authentication.
   * @type {jQuery}
   * @private
   */
  $formFieldsForLdapSettings: $('.disable-if-no-ldap'),

  /**
   * Set of elements of the form adhered to ldap auth method.
   * @type {jQuery}
   * @private
   */
  $formElementsAvailableIfLdapIsOn: $('.show-only-if-ldap-enabled'),

  /**
   * jQuery object for the ldap check segment.
   * @type {jQuery}
   */
  $ldapCheckSegment: $('#ldap-check-auth'),

  /**
   * jQuery object for the form.
   * @type {jQuery}
   */
  $formObj: $('#module-users-ui-ldap-form'),

  /**
   * jQuery object for the check credentials button.
   * @type {jQuery}
   */
  $checkAuthButton: $('.check-ldap-credentials.button'),

  /**
   * jQuery object for the getting LDAP users list button.
   * @type {jQuery}
   */
  $checkGetUsersButton: $('.check-ldap-get-users'),

  /**
   * jQuery object for the ldap check segment.
   * @type {jQuery}
   */
  $ldapCheckGetUsersSegment: $('#ldap-check-get-users'),

  /**
   * jQuery object for the use TLS selector
   * @type {jQuery}
   */
  $useTlsDropdown: $('.use-tls-dropdown'),

  /**
   * jQuery object for the server type dropdown.
   * @type {jQuery}
   */
  $ldapTypeDropdown: $('.select-ldap-field'),

  /**
   * Validation rules for the form fields.
   * @type {Object}
   */
  validateRules: {
    serverName: {
      identifier: 'serverName',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateServerNameIsEmpty
      }]
    },
    serverPort: {
      identifier: 'serverPort',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateServerPortIsEmpty
      }]
    },
    administrativeLogin: {
      identifier: 'administrativeLogin',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateAdministrativeLoginIsEmpty
      }]
    },
    administrativePasswordHidden: {
      identifier: 'administrativePasswordHidden',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateAdministrativePasswordIsEmpty
      }]
    },
    baseDN: {
      identifier: 'baseDN',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateBaseDNIsEmpty
      }]
    },
    userIdAttribute: {
      identifier: 'userIdAttribute',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateUserIdAttributeIsEmpty
      }]
    }
  },

  /**
   * Initializes the module.
   */
  initialize: function initialize() {
    moduleUsersUiIndexLdap.initializeForm(); // Handle get users list button click

    moduleUsersUiIndexLdap.$checkGetUsersButton.on('click', function (e) {
      e.preventDefault();
      moduleUsersUiIndexLdap.apiCallGetLdapUsers();
    }); // Handle check button click

    moduleUsersUiIndexLdap.$checkAuthButton.on('click', function (e) {
      e.preventDefault();
      moduleUsersUiIndexLdap.apiCallCheckAuth();
    }); // General ldap switcher

    moduleUsersUiIndexLdap.$useLdapCheckbox.checkbox({
      onChange: moduleUsersUiIndexLdap.onChangeLdapCheckbox
    });
    moduleUsersUiIndexLdap.onChangeLdapCheckbox();
    moduleUsersUiIndexLdap.$ldapTypeDropdown.dropdown({
      onChange: moduleUsersUiIndexLdap.onChangeLdapType
    }); // Handle change TLS protocol

    moduleUsersUiIndexLdap.$useTlsDropdown.dropdown({
      values: [{
        name: 'ldap://',
        value: '0',
        selected: moduleUsersUiIndexLdap.$formObj.form('get value', 'useTLS') === '0'
      }, {
        name: 'ldaps://',
        value: '1',
        selected: moduleUsersUiIndexLdap.$formObj.form('get value', 'useTLS') === '1'
      }]
    });
  },

  /**
   * Handles change LDAP dropdown.
   */
  onChangeLdapType: function onChangeLdapType(value) {
    if (value === 'OpenLDAP') {
      moduleUsersUiIndexLdap.$formObj.form('set value', 'userIdAttribute', 'uid');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'administrativeLogin', 'cn=admin,dc=example,dc=com');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'userFilter', '(objectClass=inetOrgPerson)');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'baseDN', 'dc=example,dc=com');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'organizationalUnit', 'ou=users, dc=domain, dc=com');
    } else if (value === 'ActiveDirectory') {
      moduleUsersUiIndexLdap.$formObj.form('set value', 'administrativeLogin', 'admin');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'userIdAttribute', 'samaccountname');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'userFilter', '(&(objectClass=user)(objectCategory=PERSON))');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'baseDN', 'dc=example,dc=com');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'organizationalUnit', 'ou=users, dc=domain, dc=com');
    }
  },

  /**
   * Handles get LDAP users list button click.
   */
  apiCallGetLdapUsers: function apiCallGetLdapUsers() {
    $.api({
      url: "".concat(globalRootUrl, "module-users-u-i/ldap-config/get-available-ldap-users"),
      on: 'now',
      method: 'POST',
      beforeSend: function beforeSend(settings) {
        moduleUsersUiIndexLdap.$checkGetUsersButton.addClass('loading disabled');
        settings.data = moduleUsersUiIndexLdap.$formObj.form('get values');
        return settings;
      },
      successTest: function successTest(response) {
        return response.success;
      },

      /**
       * Handles the successful response of the 'get-available-ldap-users' API request.
       * @param {object} response - The response object.
       */
      onSuccess: function onSuccess(response) {
        moduleUsersUiIndexLdap.$checkGetUsersButton.removeClass('loading disabled');
        $('.ui.message.ajax').remove();
        var html = '<ul class="ui list">';
        $.each(response.data, function (index, user) {
          html += "<li class=\"item\">".concat(user.name, " (").concat(user.login, ")</li>");
        });
        html += '</ul>';
        moduleUsersUiIndexLdap.$ldapCheckGetUsersSegment.after("<div class=\"ui icon message ajax positive\">".concat(html, "</div>"));
      },

      /**
       * Handles the failure response of the 'get-available-ldap-users' API request.
       * @param {object} response - The response object.
       */
      onFailure: function onFailure(response) {
        moduleUsersUiIndexLdap.$checkGetUsersButton.removeClass('loading disabled');
        $('.ui.message.ajax').remove();
        moduleUsersUiIndexLdap.$ldapCheckGetUsersSegment.after("<div class=\"ui icon message ajax negative\"><i class=\"icon exclamation circle\"></i>".concat(response.message, "</div>"));
      }
    });
  },

  /**
   * Handles check LDAP authentication button click.
   */
  apiCallCheckAuth: function apiCallCheckAuth() {
    $.api({
      url: "".concat(globalRootUrl, "module-users-u-i/ldap-config/check-auth"),
      on: 'now',
      method: 'POST',
      beforeSend: function beforeSend(settings) {
        moduleUsersUiIndexLdap.$checkAuthButton.addClass('loading disabled');
        settings.data = moduleUsersUiIndexLdap.$formObj.form('get values');
        return settings;
      },
      successTest: function successTest(response) {
        return response.success;
      },

      /**
       * Handles the successful response of the 'check-ldap-auth' API request.
       * @param {object} response - The response object.
       */
      onSuccess: function onSuccess(response) {
        moduleUsersUiIndexLdap.$checkAuthButton.removeClass('loading disabled');
        $('.ui.message.ajax').remove();
        moduleUsersUiIndexLdap.$ldapCheckSegment.after("<div class=\"ui icon message ajax positive\"><i class=\"icon check\"></i> ".concat(response.message, "</div>"));
      },

      /**
       * Handles the failure response of the 'check-ldap-auth' API request.
       * @param {object} response - The response object.
       */
      onFailure: function onFailure(response) {
        moduleUsersUiIndexLdap.$checkAuthButton.removeClass('loading disabled');
        $('.ui.message.ajax').remove();
        moduleUsersUiIndexLdap.$ldapCheckSegment.after("<div class=\"ui icon message ajax negative\"><i class=\"icon exclamation circle\"></i>".concat(response.message, "</div>"));
      }
    });
  },

  /**
   * Handles the change of the LDAP checkbox.
   */
  onChangeLdapCheckbox: function onChangeLdapCheckbox() {
    if (moduleUsersUiIndexLdap.$useLdapCheckbox.checkbox('is checked')) {
      moduleUsersUiIndexLdap.$formFieldsForLdapSettings.removeClass('disabled');
      moduleUsersUiIndexLdap.$formElementsAvailableIfLdapIsOn.show();
    } else {
      moduleUsersUiIndexLdap.$formFieldsForLdapSettings.addClass('disabled');
      moduleUsersUiIndexLdap.$formElementsAvailableIfLdapIsOn.hide();
    }
  },

  /**
   * Callback function before sending the form.
   * @param {object} settings - The settings object.
   * @returns {object} - The modified settings object.
   */
  cbBeforeSendForm: function cbBeforeSendForm(settings) {
    var result = settings;
    result.data = moduleUsersUiIndexLdap.$formObj.form('get values');

    if (moduleUsersUiIndexLdap.$useLdapCheckbox.checkbox('is checked')) {
      result.data.useLdapAuthMethod = '1';
    } else {
      result.data.useLdapAuthMethod = '0';
    }

    return result;
  },

  /**
   * Callback function after sending the form.
   */
  cbAfterSendForm: function cbAfterSendForm() {// Callback implementation
  },

  /**
   * Initializes the form.
   */
  initializeForm: function initializeForm() {
    Form.$formObj = moduleUsersUiIndexLdap.$formObj;
    Form.url = "".concat(globalRootUrl, "module-users-u-i/ldap-config/save");
    Form.validateRules = moduleUsersUiIndexLdap.validateRules;
    Form.cbBeforeSendForm = moduleUsersUiIndexLdap.cbBeforeSendForm;
    Form.cbAfterSendForm = moduleUsersUiIndexLdap.cbAfterSendForm;
    Form.initialize();
  }
};
$(document).ready(function () {
  moduleUsersUiIndexLdap.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb2R1bGUtdXNlcnMtdWktaW5kZXgtbGRhcC5qcyJdLCJuYW1lcyI6WyJtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwIiwiJHVzZUxkYXBDaGVja2JveCIsIiQiLCIkZm9ybUZpZWxkc0ZvckxkYXBTZXR0aW5ncyIsIiRmb3JtRWxlbWVudHNBdmFpbGFibGVJZkxkYXBJc09uIiwiJGxkYXBDaGVja1NlZ21lbnQiLCIkZm9ybU9iaiIsIiRjaGVja0F1dGhCdXR0b24iLCIkY2hlY2tHZXRVc2Vyc0J1dHRvbiIsIiRsZGFwQ2hlY2tHZXRVc2Vyc1NlZ21lbnQiLCIkdXNlVGxzRHJvcGRvd24iLCIkbGRhcFR5cGVEcm9wZG93biIsInZhbGlkYXRlUnVsZXMiLCJzZXJ2ZXJOYW1lIiwiaWRlbnRpZmllciIsInJ1bGVzIiwidHlwZSIsInByb21wdCIsImdsb2JhbFRyYW5zbGF0ZSIsIm1vZHVsZV91c2Vyc3VpX1ZhbGlkYXRlU2VydmVyTmFtZUlzRW1wdHkiLCJzZXJ2ZXJQb3J0IiwibW9kdWxlX3VzZXJzdWlfVmFsaWRhdGVTZXJ2ZXJQb3J0SXNFbXB0eSIsImFkbWluaXN0cmF0aXZlTG9naW4iLCJtb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZUFkbWluaXN0cmF0aXZlTG9naW5Jc0VtcHR5IiwiYWRtaW5pc3RyYXRpdmVQYXNzd29yZEhpZGRlbiIsIm1vZHVsZV91c2Vyc3VpX1ZhbGlkYXRlQWRtaW5pc3RyYXRpdmVQYXNzd29yZElzRW1wdHkiLCJiYXNlRE4iLCJtb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZUJhc2VETklzRW1wdHkiLCJ1c2VySWRBdHRyaWJ1dGUiLCJtb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZVVzZXJJZEF0dHJpYnV0ZUlzRW1wdHkiLCJpbml0aWFsaXplIiwiaW5pdGlhbGl6ZUZvcm0iLCJvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImFwaUNhbGxHZXRMZGFwVXNlcnMiLCJhcGlDYWxsQ2hlY2tBdXRoIiwiY2hlY2tib3giLCJvbkNoYW5nZSIsIm9uQ2hhbmdlTGRhcENoZWNrYm94IiwiZHJvcGRvd24iLCJvbkNoYW5nZUxkYXBUeXBlIiwidmFsdWVzIiwibmFtZSIsInZhbHVlIiwic2VsZWN0ZWQiLCJmb3JtIiwiYXBpIiwidXJsIiwiZ2xvYmFsUm9vdFVybCIsIm1ldGhvZCIsImJlZm9yZVNlbmQiLCJzZXR0aW5ncyIsImFkZENsYXNzIiwiZGF0YSIsInN1Y2Nlc3NUZXN0IiwicmVzcG9uc2UiLCJzdWNjZXNzIiwib25TdWNjZXNzIiwicmVtb3ZlQ2xhc3MiLCJyZW1vdmUiLCJodG1sIiwiZWFjaCIsImluZGV4IiwidXNlciIsImxvZ2luIiwiYWZ0ZXIiLCJvbkZhaWx1cmUiLCJtZXNzYWdlIiwic2hvdyIsImhpZGUiLCJjYkJlZm9yZVNlbmRGb3JtIiwicmVzdWx0IiwidXNlTGRhcEF1dGhNZXRob2QiLCJjYkFmdGVyU2VuZEZvcm0iLCJGb3JtIiwiZG9jdW1lbnQiLCJyZWFkeSJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBR0EsSUFBTUEsc0JBQXNCLEdBQUc7QUFFM0I7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNJQyxFQUFBQSxnQkFBZ0IsRUFBRUMsQ0FBQyxDQUFDLHVCQUFELENBUFE7O0FBUzNCO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDSUMsRUFBQUEsMEJBQTBCLEVBQUVELENBQUMsQ0FBQyxxQkFBRCxDQWRGOztBQWdCM0I7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNJRSxFQUFBQSxnQ0FBZ0MsRUFBRUYsQ0FBQyxDQUFDLDRCQUFELENBckJSOztBQXVCM0I7QUFDSjtBQUNBO0FBQ0E7QUFDSUcsRUFBQUEsaUJBQWlCLEVBQUVILENBQUMsQ0FBQyxrQkFBRCxDQTNCTzs7QUE2QjNCO0FBQ0o7QUFDQTtBQUNBO0FBQ0lJLEVBQUFBLFFBQVEsRUFBRUosQ0FBQyxDQUFDLDRCQUFELENBakNn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O0FBQ0hELE1BQUFBLE1BQU0sQ0FBQ2xCLElBQVAsQ0FBWW1CLGlCQUFaLEdBQWdDLEdBQWhDO0FBQ0g7O0FBRUQsV0FBT0QsTUFBUDtBQUNILEdBdlMwQjs7QUF5UzNCO0FBQ0o7QUFDQTtBQUNJRSxFQUFBQSxlQTVTMkIsNkJBNFNULENBQ2Q7QUFDSCxHQTlTMEI7O0FBZ1QzQjtBQUNKO0FBQ0E7QUFDSTNDLEVBQUFBLGNBblQyQiw0QkFtVFY7QUFDYjRDLElBQUFBLElBQUksQ0FBQ3JFLFFBQUwsR0FBZ0JOLHNCQUFzQixDQUFDTSxRQUF2QztBQUNBcUUsSUFBQUEsSUFBSSxDQUFDM0IsR0FBTCxhQUFjQyxhQUFkO0FBQ0EwQixJQUFBQSxJQUFJLENBQUMvRCxhQUFMLEdBQXFCWixzQkFBc0IsQ0FBQ1ksYUFBNUM7QUFDQStELElBQUFBLElBQUksQ0FBQ0osZ0JBQUwsR0FBd0J2RSxzQkFBc0IsQ0FBQ3VFLGdCQUEvQztBQUNBSSxJQUFBQSxJQUFJLENBQUNELGVBQUwsR0FBdUIxRSxzQkFBc0IsQ0FBQzBFLGVBQTlDO0FBQ0FDLElBQUFBLElBQUksQ0FBQzdDLFVBQUw7QUFDSDtBQTFUMEIsQ0FBL0I7QUE2VEE1QixDQUFDLENBQUMwRSxRQUFELENBQUQsQ0FBWUMsS0FBWixDQUFrQixZQUFNO0FBQ3BCN0UsRUFBQUEsc0JBQXNCLENBQUM4QixVQUF2QjtBQUNILENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogTWlrb1BCWCAtIGZyZWUgcGhvbmUgc3lzdGVtIGZvciBzbWFsbCBidXNpbmVzc1xuICogQ29weXJpZ2h0IMKpIDIwMTctMjAyMyBBbGV4ZXkgUG9ydG5vdiBhbmQgTmlrb2xheSBCZWtldG92XG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbiAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4gKiB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvclxuICogKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlXG4gKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLlxuICogSWYgbm90LCBzZWUgPGh0dHBzOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cbiAqL1xuXG4vKiBnbG9iYWwgZ2xvYmFsUm9vdFVybCwgZ2xvYmFsVHJhbnNsYXRlLCBGb3JtLCBQYnhBcGkqL1xuXG5cbmNvbnN0IG1vZHVsZVVzZXJzVWlJbmRleExkYXAgPSB7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja2JveCBmb3IgTERBUCBhdXRoZW50aWNhdGlvbi5cbiAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgJHVzZUxkYXBDaGVja2JveDogJCgnI3VzZS1sZGFwLWF1dGgtbWV0aG9kJyksXG5cbiAgICAvKipcbiAgICAgKiBTZXQgb2YgZm9ybSBmaWVsZHMgdG8gdXNlIGZvciBMREFQIGF1dGhlbnRpY2F0aW9uLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAkZm9ybUZpZWxkc0ZvckxkYXBTZXR0aW5nczogJCgnLmRpc2FibGUtaWYtbm8tbGRhcCcpLFxuXG4gICAgLyoqXG4gICAgICogU2V0IG9mIGVsZW1lbnRzIG9mIHRoZSBmb3JtIGFkaGVyZWQgdG8gbGRhcCBhdXRoIG1ldGhvZC5cbiAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgJGZvcm1FbGVtZW50c0F2YWlsYWJsZUlmTGRhcElzT246ICQoJy5zaG93LW9ubHktaWYtbGRhcC1lbmFibGVkJyksXG5cbiAgICAvKipcbiAgICAgKiBqUXVlcnkgb2JqZWN0IGZvciB0aGUgbGRhcCBjaGVjayBzZWdtZW50LlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICovXG4gICAgJGxkYXBDaGVja1NlZ21lbnQ6ICQoJyNsZGFwLWNoZWNrLWF1dGgnKSxcblxuICAgIC8qKlxuICAgICAqIGpRdWVyeSBvYmplY3QgZm9yIHRoZSBmb3JtLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICovXG4gICAgJGZvcm1PYmo6ICQoJyNtb2R1bGUtdXNlcnMtdWktbGRhcC1mb3JtJyksXG5cbiAgICAvKipcbiAgICAgKiBqUXVlcnkgb2JqZWN0IGZvciB0aGUgY2hlY2sgY3JlZGVudGlhbHMgYnV0dG9uLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICovXG4gICAgJGNoZWNrQXV0aEJ1dHRvbjogJCgnLmNoZWNrLWxkYXAtY3JlZGVudGlhbHMuYnV0dG9uJyksXG5cblxuICAgIC8qKlxuICAgICAqIGpRdWVyeSBvYmplY3QgZm9yIHRoZSBnZXR0aW5nIExEQVAgdXNlcnMgbGlzdCBidXR0b24uXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkY2hlY2tHZXRVc2Vyc0J1dHRvbjogJCgnLmNoZWNrLWxkYXAtZ2V0LXVzZXJzJyksXG5cbiAgICAvKipcbiAgICAgKiBqUXVlcnkgb2JqZWN0IGZvciB0aGUgbGRhcCBjaGVjayBzZWdtZW50LlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICovXG4gICAgJGxkYXBDaGVja0dldFVzZXJzU2VnbWVudDogJCgnI2xkYXAtY2hlY2stZ2V0LXVzZXJzJyksXG5cbiAgICAvKipcbiAgICAgKiBqUXVlcnkgb2JqZWN0IGZvciB0aGUgdXNlIFRMUyBzZWxlY3RvclxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICovXG4gICAgJHVzZVRsc0Ryb3Bkb3duOiAkKCcudXNlLXRscy1kcm9wZG93bicpLFxuXG4gICAgLyoqXG4gICAgICogalF1ZXJ5IG9iamVjdCBmb3IgdGhlIHNlcnZlciB0eXBlIGRyb3Bkb3duLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICovXG4gICAgJGxkYXBUeXBlRHJvcGRvd246ICQoJy5zZWxlY3QtbGRhcC1maWVsZCcpLFxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGlvbiBydWxlcyBmb3IgdGhlIGZvcm0gZmllbGRzLlxuICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgICovXG4gICAgdmFsaWRhdGVSdWxlczoge1xuICAgICAgICBzZXJ2ZXJOYW1lOiB7XG4gICAgICAgICAgICBpZGVudGlmaWVyOiAnc2VydmVyTmFtZScsXG4gICAgICAgICAgICBydWxlczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2VtcHR5JyxcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubW9kdWxlX3VzZXJzdWlfVmFsaWRhdGVTZXJ2ZXJOYW1lSXNFbXB0eSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgc2VydmVyUG9ydDoge1xuICAgICAgICAgICAgaWRlbnRpZmllcjogJ3NlcnZlclBvcnQnLFxuICAgICAgICAgICAgcnVsZXM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlbXB0eScsXG4gICAgICAgICAgICAgICAgICAgIHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm1vZHVsZV91c2Vyc3VpX1ZhbGlkYXRlU2VydmVyUG9ydElzRW1wdHksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICAgIGFkbWluaXN0cmF0aXZlTG9naW46IHtcbiAgICAgICAgICAgIGlkZW50aWZpZXI6ICdhZG1pbmlzdHJhdGl2ZUxvZ2luJyxcbiAgICAgICAgICAgIHJ1bGVzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1wdHknLFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5tb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZUFkbWluaXN0cmF0aXZlTG9naW5Jc0VtcHR5LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICBhZG1pbmlzdHJhdGl2ZVBhc3N3b3JkSGlkZGVuOiB7XG4gICAgICAgICAgICBpZGVudGlmaWVyOiAnYWRtaW5pc3RyYXRpdmVQYXNzd29yZEhpZGRlbicsXG4gICAgICAgICAgICBydWxlczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2VtcHR5JyxcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubW9kdWxlX3VzZXJzdWlfVmFsaWRhdGVBZG1pbmlzdHJhdGl2ZVBhc3N3b3JkSXNFbXB0eSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFzZUROOiB7XG4gICAgICAgICAgICBpZGVudGlmaWVyOiAnYmFzZUROJyxcbiAgICAgICAgICAgIHJ1bGVzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1wdHknLFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5tb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZUJhc2VETklzRW1wdHksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICAgIHVzZXJJZEF0dHJpYnV0ZToge1xuICAgICAgICAgICAgaWRlbnRpZmllcjogJ3VzZXJJZEF0dHJpYnV0ZScsXG4gICAgICAgICAgICBydWxlczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2VtcHR5JyxcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubW9kdWxlX3VzZXJzdWlfVmFsaWRhdGVVc2VySWRBdHRyaWJ1dGVJc0VtcHR5LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyB0aGUgbW9kdWxlLlxuICAgICAqL1xuICAgIGluaXRpYWxpemUoKSB7XG4gICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuaW5pdGlhbGl6ZUZvcm0oKTtcblxuICAgICAgICAvLyBIYW5kbGUgZ2V0IHVzZXJzIGxpc3QgYnV0dG9uIGNsaWNrXG4gICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGNoZWNrR2V0VXNlcnNCdXR0b24ub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuYXBpQ2FsbEdldExkYXBVc2VycygpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBIYW5kbGUgY2hlY2sgYnV0dG9uIGNsaWNrXG4gICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGNoZWNrQXV0aEJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC5hcGlDYWxsQ2hlY2tBdXRoKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEdlbmVyYWwgbGRhcCBzd2l0Y2hlclxuICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiR1c2VMZGFwQ2hlY2tib3guY2hlY2tib3goe1xuICAgICAgICAgICAgb25DaGFuZ2U6IG1vZHVsZVVzZXJzVWlJbmRleExkYXAub25DaGFuZ2VMZGFwQ2hlY2tib3gsXG4gICAgICAgIH0pO1xuICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLm9uQ2hhbmdlTGRhcENoZWNrYm94KCk7XG5cbiAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kbGRhcFR5cGVEcm9wZG93bi5kcm9wZG93bih7XG4gICAgICAgICAgICBvbkNoYW5nZTogbW9kdWxlVXNlcnNVaUluZGV4TGRhcC5vbkNoYW5nZUxkYXBUeXBlLFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gSGFuZGxlIGNoYW5nZSBUTFMgcHJvdG9jb2xcbiAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kdXNlVGxzRHJvcGRvd24uZHJvcGRvd24oe1xuICAgICAgICAgICAgdmFsdWVzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnbGRhcDovLycsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnMCcsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtT2JqLmZvcm0oJ2dldCB2YWx1ZScsICd1c2VUTFMnKSA9PT0gJzAnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdsZGFwczovLycsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnMScsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtT2JqLmZvcm0oJ2dldCB2YWx1ZScsICd1c2VUTFMnKSA9PT0gJzEnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIGNoYW5nZSBMREFQIGRyb3Bkb3duLlxuICAgICAqL1xuICAgIG9uQ2hhbmdlTGRhcFR5cGUodmFsdWUpe1xuICAgICAgICBpZih2YWx1ZT09PSdPcGVuTERBUCcpe1xuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iai5mb3JtKCdzZXQgdmFsdWUnLCd1c2VySWRBdHRyaWJ1dGUnLCd1aWQnKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywnYWRtaW5pc3RyYXRpdmVMb2dpbicsJ2NuPWFkbWluLGRjPWV4YW1wbGUsZGM9Y29tJyk7XG4gICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtT2JqLmZvcm0oJ3NldCB2YWx1ZScsJ3VzZXJGaWx0ZXInLCcob2JqZWN0Q2xhc3M9aW5ldE9yZ1BlcnNvbiknKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywnYmFzZUROJywnZGM9ZXhhbXBsZSxkYz1jb20nKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywnb3JnYW5pemF0aW9uYWxVbml0Jywnb3U9dXNlcnMsIGRjPWRvbWFpbiwgZGM9Y29tJyk7XG4gICAgICAgIH0gZWxzZSBpZih2YWx1ZT09PSdBY3RpdmVEaXJlY3RvcnknKXtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywnYWRtaW5pc3RyYXRpdmVMb2dpbicsJ2FkbWluJyk7XG4gICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtT2JqLmZvcm0oJ3NldCB2YWx1ZScsJ3VzZXJJZEF0dHJpYnV0ZScsJ3NhbWFjY291bnRuYW1lJylcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywndXNlckZpbHRlcicsJygmKG9iamVjdENsYXNzPXVzZXIpKG9iamVjdENhdGVnb3J5PVBFUlNPTikpJyk7XG4gICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtT2JqLmZvcm0oJ3NldCB2YWx1ZScsJ2Jhc2VETicsJ2RjPWV4YW1wbGUsZGM9Y29tJyk7XG4gICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtT2JqLmZvcm0oJ3NldCB2YWx1ZScsJ29yZ2FuaXphdGlvbmFsVW5pdCcsJ291PXVzZXJzLCBkYz1kb21haW4sIGRjPWNvbScpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIGdldCBMREFQIHVzZXJzIGxpc3QgYnV0dG9uIGNsaWNrLlxuICAgICAqL1xuICAgIGFwaUNhbGxHZXRMZGFwVXNlcnMoKXtcbiAgICAgICAgJC5hcGkoe1xuICAgICAgICAgICAgdXJsOiBgJHtnbG9iYWxSb290VXJsfW1vZHVsZS11c2Vycy11LWkvbGRhcC1jb25maWcvZ2V0LWF2YWlsYWJsZS1sZGFwLXVzZXJzYCxcbiAgICAgICAgICAgIG9uOiAnbm93JyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYmVmb3JlU2VuZChzZXR0aW5ncykge1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGNoZWNrR2V0VXNlcnNCdXR0b24uYWRkQ2xhc3MoJ2xvYWRpbmcgZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICBzZXR0aW5ncy5kYXRhID0gbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iai5mb3JtKCdnZXQgdmFsdWVzJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNldHRpbmdzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Y2Nlc3NUZXN0KHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3VjY2VzcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEhhbmRsZXMgdGhlIHN1Y2Nlc3NmdWwgcmVzcG9uc2Ugb2YgdGhlICdnZXQtYXZhaWxhYmxlLWxkYXAtdXNlcnMnIEFQSSByZXF1ZXN0LlxuICAgICAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHJlc3BvbnNlIC0gVGhlIHJlc3BvbnNlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGNoZWNrR2V0VXNlcnNCdXR0b24ucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcgZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICAkKCcudWkubWVzc2FnZS5hamF4JykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgbGV0IGh0bWwgPSAnPHVsIGNsYXNzPVwidWkgbGlzdFwiPic7XG4gICAgICAgICAgICAgICAgJC5lYWNoKHJlc3BvbnNlLmRhdGEsIChpbmRleCwgdXNlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBodG1sICs9IGA8bGkgY2xhc3M9XCJpdGVtXCI+JHt1c2VyLm5hbWV9ICgke3VzZXIubG9naW59KTwvbGk+YDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L3VsPic7XG4gICAgICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kbGRhcENoZWNrR2V0VXNlcnNTZWdtZW50LmFmdGVyKGA8ZGl2IGNsYXNzPVwidWkgaWNvbiBtZXNzYWdlIGFqYXggcG9zaXRpdmVcIj4ke2h0bWx9PC9kaXY+YCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBIYW5kbGVzIHRoZSBmYWlsdXJlIHJlc3BvbnNlIG9mIHRoZSAnZ2V0LWF2YWlsYWJsZS1sZGFwLXVzZXJzJyBBUEkgcmVxdWVzdC5cbiAgICAgICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSByZXNwb25zZSAtIFRoZSByZXNwb25zZSBvYmplY3QuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIG9uRmFpbHVyZTogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRjaGVja0dldFVzZXJzQnV0dG9uLnJlbW92ZUNsYXNzKCdsb2FkaW5nIGRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgJCgnLnVpLm1lc3NhZ2UuYWpheCcpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGxkYXBDaGVja0dldFVzZXJzU2VnbWVudC5hZnRlcihgPGRpdiBjbGFzcz1cInVpIGljb24gbWVzc2FnZSBhamF4IG5lZ2F0aXZlXCI+PGkgY2xhc3M9XCJpY29uIGV4Y2xhbWF0aW9uIGNpcmNsZVwiPjwvaT4ke3Jlc3BvbnNlLm1lc3NhZ2V9PC9kaXY+YCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIGNoZWNrIExEQVAgYXV0aGVudGljYXRpb24gYnV0dG9uIGNsaWNrLlxuICAgICAqL1xuICAgIGFwaUNhbGxDaGVja0F1dGgoKXtcbiAgICAgICAgJC5hcGkoe1xuICAgICAgICAgICAgdXJsOiBgJHtnbG9iYWxSb290VXJsfW1vZHVsZS11c2Vycy11LWkvbGRhcC1jb25maWcvY2hlY2stYXV0aGAsXG4gICAgICAgICAgICBvbjogJ25vdycsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGJlZm9yZVNlbmQoc2V0dGluZ3MpIHtcbiAgICAgICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRjaGVja0F1dGhCdXR0b24uYWRkQ2xhc3MoJ2xvYWRpbmcgZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICBzZXR0aW5ncy5kYXRhID0gbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iai5mb3JtKCdnZXQgdmFsdWVzJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNldHRpbmdzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Y2Nlc3NUZXN0KHJlc3BvbnNlKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3VjY2VzcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEhhbmRsZXMgdGhlIHN1Y2Nlc3NmdWwgcmVzcG9uc2Ugb2YgdGhlICdjaGVjay1sZGFwLWF1dGgnIEFQSSByZXF1ZXN0LlxuICAgICAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHJlc3BvbnNlIC0gVGhlIHJlc3BvbnNlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGNoZWNrQXV0aEJ1dHRvbi5yZW1vdmVDbGFzcygnbG9hZGluZyBkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgICQoJy51aS5tZXNzYWdlLmFqYXgnKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRsZGFwQ2hlY2tTZWdtZW50LmFmdGVyKGA8ZGl2IGNsYXNzPVwidWkgaWNvbiBtZXNzYWdlIGFqYXggcG9zaXRpdmVcIj48aSBjbGFzcz1cImljb24gY2hlY2tcIj48L2k+ICR7cmVzcG9uc2UubWVzc2FnZX08L2Rpdj5gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEhhbmRsZXMgdGhlIGZhaWx1cmUgcmVzcG9uc2Ugb2YgdGhlICdjaGVjay1sZGFwLWF1dGgnIEFQSSByZXF1ZXN0LlxuICAgICAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHJlc3BvbnNlIC0gVGhlIHJlc3BvbnNlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25GYWlsdXJlOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGNoZWNrQXV0aEJ1dHRvbi5yZW1vdmVDbGFzcygnbG9hZGluZyBkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgICQoJy51aS5tZXNzYWdlLmFqYXgnKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRsZGFwQ2hlY2tTZWdtZW50LmFmdGVyKGA8ZGl2IGNsYXNzPVwidWkgaWNvbiBtZXNzYWdlIGFqYXggbmVnYXRpdmVcIj48aSBjbGFzcz1cImljb24gZXhjbGFtYXRpb24gY2lyY2xlXCI+PC9pPiR7cmVzcG9uc2UubWVzc2FnZX08L2Rpdj5gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgdGhlIGNoYW5nZSBvZiB0aGUgTERBUCBjaGVja2JveC5cbiAgICAgKi9cbiAgICBvbkNoYW5nZUxkYXBDaGVja2JveCgpe1xuICAgICAgICBpZiAobW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kdXNlTGRhcENoZWNrYm94LmNoZWNrYm94KCdpcyBjaGVja2VkJykpIHtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1GaWVsZHNGb3JMZGFwU2V0dGluZ3MucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtRWxlbWVudHNBdmFpbGFibGVJZkxkYXBJc09uLnNob3coKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1GaWVsZHNGb3JMZGFwU2V0dGluZ3MuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtRWxlbWVudHNBdmFpbGFibGVJZkxkYXBJc09uLmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDYWxsYmFjayBmdW5jdGlvbiBiZWZvcmUgc2VuZGluZyB0aGUgZm9ybS5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gc2V0dGluZ3MgLSBUaGUgc2V0dGluZ3Mgb2JqZWN0LlxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IC0gVGhlIG1vZGlmaWVkIHNldHRpbmdzIG9iamVjdC5cbiAgICAgKi9cbiAgICBjYkJlZm9yZVNlbmRGb3JtKHNldHRpbmdzKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHNldHRpbmdzO1xuICAgICAgICByZXN1bHQuZGF0YSA9IG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnZ2V0IHZhbHVlcycpO1xuICAgICAgICBpZiAobW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kdXNlTGRhcENoZWNrYm94LmNoZWNrYm94KCdpcyBjaGVja2VkJykpe1xuICAgICAgICAgICAgcmVzdWx0LmRhdGEudXNlTGRhcEF1dGhNZXRob2QgPSAnMSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQuZGF0YS51c2VMZGFwQXV0aE1ldGhvZCA9ICcwJztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIGZ1bmN0aW9uIGFmdGVyIHNlbmRpbmcgdGhlIGZvcm0uXG4gICAgICovXG4gICAgY2JBZnRlclNlbmRGb3JtKCkge1xuICAgICAgICAvLyBDYWxsYmFjayBpbXBsZW1lbnRhdGlvblxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyB0aGUgZm9ybS5cbiAgICAgKi9cbiAgICBpbml0aWFsaXplRm9ybSgpIHtcbiAgICAgICAgRm9ybS4kZm9ybU9iaiA9IG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmo7XG4gICAgICAgIEZvcm0udXJsID0gYCR7Z2xvYmFsUm9vdFVybH1tb2R1bGUtdXNlcnMtdS1pL2xkYXAtY29uZmlnL3NhdmVgO1xuICAgICAgICBGb3JtLnZhbGlkYXRlUnVsZXMgPSBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLnZhbGlkYXRlUnVsZXM7XG4gICAgICAgIEZvcm0uY2JCZWZvcmVTZW5kRm9ybSA9IG1vZHVsZVVzZXJzVWlJbmRleExkYXAuY2JCZWZvcmVTZW5kRm9ybTtcbiAgICAgICAgRm9ybS5jYkFmdGVyU2VuZEZvcm0gPSBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLmNiQWZ0ZXJTZW5kRm9ybTtcbiAgICAgICAgRm9ybS5pbml0aWFsaXplKCk7XG4gICAgfSxcbn07XG5cbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcbiAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLmluaXRpYWxpemUoKTtcbn0pO1xuIl19