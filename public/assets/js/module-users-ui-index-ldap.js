"use strict";

/*
 * MikoPBX - free phone system for small business
 * Copyright Â© 2017-2023 Alexey Portnov and Nikolay Beketov
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see <https://www.gnu.org/licenses/>.
 */

/* global globalRootUrl, globalTranslate, Form, PbxApi*/
var moduleUsersUiIndexLdap = {
  /**
   * Checkbox for LDAP authentication.
   * @type {jQuery}
   * @private
   */
  $useLdapCheckbox: $('#use-ldap-auth-method'),

  /**
   * Set of form fields to use for LDAP authentication.
   * @type {jQuery}
   * @private
   */
  $formFieldsForLdapSettings: $('.disable-if-no-ldap'),

  /**
   * Set of elements of the form adhered to ldap auth method.
   * @type {jQuery}
   * @private
   */
  $formElementsAvailableIfLdapIsOn: $('.show-only-if-ldap-enabled'),

  /**
   * jQuery object for the ldap check segment.
   * @type {jQuery}
   */
  $ldapCheckSegment: $('#ldap-check-auth'),

  /**
   * jQuery object for the form.
   * @type {jQuery}
   */
  $formObj: $('#module-users-ui-ldap-form'),

  /**
   * jQuery object for the check credentials button.
   * @type {jQuery}
   */
  $checkAuthButton: $('.check-ldap-credentials.button'),

  /**
   * jQuery object for the getting LDAP users list button.
   * @type {jQuery}
   */
  $checkGetUsersButton: $('.check-ldap-get-users'),

  /**
   * jQuery object for the ldap check segment.
   * @type {jQuery}
   */
  $ldapCheckGetUsersSegment: $('#ldap-check-get-users'),

  /**
   * jQuery object for the use TLS selector
   * @type {jQuery}
   */
  $useTlsDropdown: $('.use-tls-dropdown'),

  /**
   * jQuery object for the server type dropdown.
   * @type {jQuery}
   */
  $ldapTypeDropdown: $('.select-ldap-field'),

  /**
   * Validation rules for the form fields.
   * @type {Object}
   */
  validateRules: {
    serverName: {
      identifier: 'serverName',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateServerNameIsEmpty
      }]
    },
    serverPort: {
      identifier: 'serverPort',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateServerPortIsEmpty
      }]
    },
    administrativeLogin: {
      identifier: 'administrativeLogin',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateAdministrativeLoginIsEmpty
      }]
    },
    administrativePasswordHidden: {
      identifier: 'administrativePasswordHidden',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateAdministrativePasswordIsEmpty
      }]
    },
    baseDN: {
      identifier: 'baseDN',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateBaseDNIsEmpty
      }]
    },
    userIdAttribute: {
      identifier: 'userIdAttribute',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.module_usersui_ValidateUserIdAttributeIsEmpty
      }]
    }
  },

  /**
   * Initializes the module.
   */
  initialize: function initialize() {
    moduleUsersUiIndexLdap.initializeForm(); // Handle get users list button click

    moduleUsersUiIndexLdap.$checkGetUsersButton.on('click', function (e) {
      e.preventDefault();
      moduleUsersUiIndexLdap.apiCallGetLdapUsers();
    }); // Handle check button click

    moduleUsersUiIndexLdap.$checkAuthButton.on('click', function (e) {
      e.preventDefault();
      moduleUsersUiIndexLdap.apiCallCheckAuth();
    }); // General ldap switcher

    moduleUsersUiIndexLdap.$useLdapCheckbox.checkbox({
      onChange: moduleUsersUiIndexLdap.onChangeLdapCheckbox
    });
    moduleUsersUiIndexLdap.onChangeLdapCheckbox();
    moduleUsersUiIndexLdap.$ldapTypeDropdown.dropdown({
      onChange: moduleUsersUiIndexLdap.onChangeLdapType
    }); // Handle change TLS protocol

    moduleUsersUiIndexLdap.$useTlsDropdown.dropdown({
      values: [{
        name: 'ldap://',
        value: '0',
        selected: moduleUsersUiIndexLdap.$formObj.form('get value', 'useTLS') === '0'
      }, {
        name: 'ldaps://',
        value: '1',
        selected: moduleUsersUiIndexLdap.$formObj.form('get value', 'useTLS') === '1'
      }]
    });
  },

  /**
   * Handles change LDAP dropdown.
   */
  onChangeLdapType: function onChangeLdapType(value) {
    if (value === 'OpenLDAP') {
      moduleUsersUiIndexLdap.$formObj.form('set value', 'userIdAttribute', 'uid');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'administrativeLogin', 'cn=admin,dc=example,dc=com');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'userFilter', '(objectClass=inetOrgPerson)');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'baseDN', 'dc=example,dc=com');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'organizationalUnit', 'ou=users, dc=domain, dc=com');
    } else if (value === 'ActiveDirectory') {
      moduleUsersUiIndexLdap.$formObj.form('set value', 'administrativeLogin', 'admin');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'userIdAttribute', 'samaccountname');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'userFilter', '(&(objectClass=user)(objectCategory=PERSON))');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'baseDN', 'dc=example,dc=com');
      moduleUsersUiIndexLdap.$formObj.form('set value', 'organizationalUnit', 'ou=users, dc=domain, dc=com');
    }
  },

  /**
   * Handles get LDAP users list button click.
   */
  apiCallGetLdapUsers: function apiCallGetLdapUsers() {
    $.api({
      url: "".concat(globalRootUrl, "module-users-u-i/ldap-config/get-available-ldap-users"),
      on: 'now',
      method: 'POST',
      beforeSend: function beforeSend(settings) {
        moduleUsersUiIndexLdap.$checkGetUsersButton.addClass('loading disabled');
        settings.data = moduleUsersUiIndexLdap.$formObj.form('get values');
        return settings;
      },
      successTest: function successTest(response) {
        return response.success;
      },

      /**
       * Handles the successful response of the 'get-available-ldap-users' API request.
       * @param {object} response - The response object.
       */
      onSuccess: function onSuccess(response) {
        moduleUsersUiIndexLdap.$checkGetUsersButton.removeClass('loading disabled');
        $('.ui.message.ajax').remove();
        var html = '<ul class="ui list">';

        if (response.data.length === 0) {
          html += "<li class=\"item\">".concat(globaltranslate.module_usersui_EmptyServerResponse, "</li>");
        } else {
          $.each(response.data, function (index, user) {
            html += "<li class=\"item\">".concat(user.name, " (").concat(user.login, ")</li>");
          });
        }

        html += '</ul>';
        moduleUsersUiIndexLdap.$ldapCheckGetUsersSegment.after("<div class=\"ui icon message ajax positive\">".concat(html, "</div>"));
      },

      /**
       * Handles the failure response of the 'get-available-ldap-users' API request.
       * @param {object} response - The response object.
       */
      onFailure: function onFailure(response) {
        moduleUsersUiIndexLdap.$checkGetUsersButton.removeClass('loading disabled');
        $('.ui.message.ajax').remove();
        moduleUsersUiIndexLdap.$ldapCheckGetUsersSegment.after("<div class=\"ui icon message ajax negative\"><i class=\"icon exclamation circle\"></i>".concat(response.message, "</div>"));
      }
    });
  },

  /**
   * Handles check LDAP authentication button click.
   */
  apiCallCheckAuth: function apiCallCheckAuth() {
    $.api({
      url: "".concat(globalRootUrl, "module-users-u-i/ldap-config/check-auth"),
      on: 'now',
      method: 'POST',
      beforeSend: function beforeSend(settings) {
        moduleUsersUiIndexLdap.$checkAuthButton.addClass('loading disabled');
        settings.data = moduleUsersUiIndexLdap.$formObj.form('get values');
        return settings;
      },
      successTest: function successTest(response) {
        return response.success;
      },

      /**
       * Handles the successful response of the 'check-ldap-auth' API request.
       * @param {object} response - The response object.
       */
      onSuccess: function onSuccess(response) {
        moduleUsersUiIndexLdap.$checkAuthButton.removeClass('loading disabled');
        $('.ui.message.ajax').remove();
        moduleUsersUiIndexLdap.$ldapCheckSegment.after("<div class=\"ui icon message ajax positive\"><i class=\"icon check\"></i> ".concat(response.message, "</div>"));
      },

      /**
       * Handles the failure response of the 'check-ldap-auth' API request.
       * @param {object} response - The response object.
       */
      onFailure: function onFailure(response) {
        moduleUsersUiIndexLdap.$checkAuthButton.removeClass('loading disabled');
        $('.ui.message.ajax').remove();
        moduleUsersUiIndexLdap.$ldapCheckSegment.after("<div class=\"ui icon message ajax negative\"><i class=\"icon exclamation circle\"></i>".concat(response.message, "</div>"));
      }
    });
  },

  /**
   * Handles the change of the LDAP checkbox.
   */
  onChangeLdapCheckbox: function onChangeLdapCheckbox() {
    if (moduleUsersUiIndexLdap.$useLdapCheckbox.checkbox('is checked')) {
      moduleUsersUiIndexLdap.$formFieldsForLdapSettings.removeClass('disabled');
      moduleUsersUiIndexLdap.$formElementsAvailableIfLdapIsOn.show();
    } else {
      moduleUsersUiIndexLdap.$formFieldsForLdapSettings.addClass('disabled');
      moduleUsersUiIndexLdap.$formElementsAvailableIfLdapIsOn.hide();
    }
  },

  /**
   * Callback function before sending the form.
   * @param {object} settings - The settings object.
   * @returns {object} - The modified settings object.
   */
  cbBeforeSendForm: function cbBeforeSendForm(settings) {
    var result = settings;
    result.data = moduleUsersUiIndexLdap.$formObj.form('get values');

    if (moduleUsersUiIndexLdap.$useLdapCheckbox.checkbox('is checked')) {
      result.data.useLdapAuthMethod = '1';
    } else {
      result.data.useLdapAuthMethod = '0';
    }

    return result;
  },

  /**
   * Callback function after sending the form.
   */
  cbAfterSendForm: function cbAfterSendForm() {// Callback implementation
  },

  /**
   * Initializes the form.
   */
  initializeForm: function initializeForm() {
    Form.$formObj = moduleUsersUiIndexLdap.$formObj;
    Form.url = "".concat(globalRootUrl, "module-users-u-i/ldap-config/save");
    Form.validateRules = moduleUsersUiIndexLdap.validateRules;
    Form.cbBeforeSendForm = moduleUsersUiIndexLdap.cbBeforeSendForm;
    Form.cbAfterSendForm = moduleUsersUiIndexLdap.cbAfterSendForm;
    Form.initialize();
  }
};
$(document).ready(function () {
  moduleUsersUiIndexLdap.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb2R1bGUtdXNlcnMtdWktaW5kZXgtbGRhcC5qcyJdLCJuYW1lcyI6WyJtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwIiwiJHVzZUxkYXBDaGVja2JveCIsIiQiLCIkZm9ybUZpZWxkc0ZvckxkYXBTZXR0aW5ncyIsIiRmb3JtRWxlbWVudHNBdmFpbGFibGVJZkxkYXBJc09uIiwiJGxkYXBDaGVja1NlZ21lbnQiLCIkZm9ybU9iaiIsIiRjaGVja0F1dGhCdXR0b24iLCIkY2hlY2tHZXRVc2Vyc0J1dHRvbiIsIiRsZGFwQ2hlY2tHZXRVc2Vyc1NlZ21lbnQiLCIkdXNlVGxzRHJvcGRvd24iLCIkbGRhcFR5cGVEcm9wZG93biIsInZhbGlkYXRlUnVsZXMiLCJzZXJ2ZXJOYW1lIiwiaWRlbnRpZmllciIsInJ1bGVzIiwidHlwZSIsInByb21wdCIsImdsb2JhbFRyYW5zbGF0ZSIsIm1vZHVsZV91c2Vyc3VpX1ZhbGlkYXRlU2VydmVyTmFtZUlzRW1wdHkiLCJzZXJ2ZXJQb3J0IiwibW9kdWxlX3VzZXJzdWlfVmFsaWRhdGVTZXJ2ZXJQb3J0SXNFbXB0eSIsImFkbWluaXN0cmF0aXZlTG9naW4iLCJtb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZUFkbWluaXN0cmF0aXZlTG9naW5Jc0VtcHR5IiwiYWRtaW5pc3RyYXRpdmVQYXNzd29yZEhpZGRlbiIsIm1vZHVsZV91c2Vyc3VpX1ZhbGlkYXRlQWRtaW5pc3RyYXRpdmVQYXNzd29yZElzRW1wdHkiLCJiYXNlRE4iLCJtb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZUJhc2VETklzRW1wdHkiLCJ1c2VySWRBdHRyaWJ1dGUiLCJtb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZVVzZXJJZEF0dHJpYnV0ZUlzRW1wdHkiLCJpbml0aWFsaXplIiwiaW5pdGlhbGl6ZUZvcm0iLCJvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImFwaUNhbGxHZXRMZGFwVXNlcnMiLCJhcGlDYWxsQ2hlY2tBdXRoIiwiY2hlY2tib3giLCJvbkNoYW5nZSIsIm9uQ2hhbmdlTGRhcENoZWNrYm94IiwiZHJvcGRvd24iLCJvbkNoYW5nZUxkYXBUeXBlIiwidmFsdWVzIiwibmFtZSIsInZhbHVlIiwic2VsZWN0ZWQiLCJmb3JtIiwiYXBpIiwidXJsIiwiZ2xvYmFsUm9vdFVybCIsIm1ldGhvZCIsImJlZm9yZVNlbmQiLCJzZXR0aW5ncyIsImFkZENsYXNzIiwiZGF0YSIsInN1Y2Nlc3NUZXN0IiwicmVzcG9uc2UiLCJzdWNjZXNzIiwib25TdWNjZXNzIiwicmVtb3ZlQ2xhc3MiLCJyZW1vdmUiLCJodG1sIiwibGVuZ3RoIiwiZ2xvYmFsdHJhbnNsYXRlIiwibW9kdWxlX3VzZXJzdWlfRW1wdHlTZXJ2ZXJSZXNwb25zZSIsImVhY2giLCJpbmRleCIsInVzZXIiLCJsb2dpbiIsImFmdGVyIiwib25GYWlsdXJlIiwibWVzc2FnZSIsInNob3ciLCJoaWRlIiwiY2JCZWZvcmVTZW5kRm9ybSIsInJlc3VsdCIsInVzZUxkYXBBdXRoTWV0aG9kIiwiY2JBZnRlclNlbmRGb3JtIiwiRm9ybSIsImRvY3VtZW50IiwicmVhZHkiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUdBLElBQU1BLHNCQUFzQixHQUFHO0FBRTNCO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDSUMsRUFBQUEsZ0JBQWdCLEVBQUVDLENBQUMsQ0FBQyx1QkFBRCxDQVBROztBQVMzQjtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0lDLEVBQUFBLDBCQUEwQixFQUFFRCxDQUFDLENBQUMscUJBQUQsQ0FkRjs7QUFnQjNCO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDSUUsRUFBQUEsZ0NBQWdDLEVBQUVGLENBQUMsQ0FBQyw0QkFBRCxDQXJCUjs7QUF1QjNCO0FBQ0o7QUFDQTtBQUNBO0FBQ0lHLEVBQUFBLGlCQUFpQixFQUFFSCxDQUFDLENBQUMsa0JBQUQsQ0EzQk87O0FB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LHNCQUFzQixDQUFDTSxRQUF2QixDQUFnQ3dDLElBQWhDLENBQXFDLFlBQXJDLENBQWQ7O0FBQ0EsUUFBSTlDLHNCQUFzQixDQUFDQyxnQkFBdkIsQ0FBd0NvQyxRQUF4QyxDQUFpRCxZQUFqRCxDQUFKLEVBQW1FO0FBQy9Ec0MsTUFBQUEsTUFBTSxDQUFDckIsSUFBUCxDQUFZc0IsaUJBQVosR0FBZ0MsR0FBaEM7QUFDSCxLQUZELE1BRU87QUFDSEQsTUFBQUEsTUFBTSxDQUFDckIsSUFBUCxDQUFZc0IsaUJBQVosR0FBZ0MsR0FBaEM7QUFDSDs7QUFFRCxXQUFPRCxNQUFQO0FBQ0gsR0EzUzBCOztBQTZTM0I7QUFDSjtBQUNBO0FBQ0lFLEVBQUFBLGVBaFQyQiw2QkFnVFQsQ0FDZDtBQUNILEdBbFQwQjs7QUFvVDNCO0FBQ0o7QUFDQTtBQUNJOUMsRUFBQUEsY0F2VDJCLDRCQXVUVjtBQUNiK0MsSUFBQUEsSUFBSSxDQUFDeEUsUUFBTCxHQUFnQk4sc0JBQXNCLENBQUNNLFFBQXZDO0FBQ0F3RSxJQUFBQSxJQUFJLENBQUM5QixHQUFMLGFBQWNDLGFBQWQ7QUFDQTZCLElBQUFBLElBQUksQ0FBQ2xFLGFBQUwsR0FBcUJaLHNCQUFzQixDQUFDWSxhQUE1QztBQUNBa0UsSUFBQUEsSUFBSSxDQUFDSixnQkFBTCxHQUF3QjFFLHNCQUFzQixDQUFDMEUsZ0JBQS9DO0FBQ0FJLElBQUFBLElBQUksQ0FBQ0QsZUFBTCxHQUF1QjdFLHNCQUFzQixDQUFDNkUsZUFBOUM7QUFDQUMsSUFBQUEsSUFBSSxDQUFDaEQsVUFBTDtBQUNIO0FBOVQwQixDQUEvQjtBQWlVQTVCLENBQUMsQ0FBQzZFLFFBQUQsQ0FBRCxDQUFZQyxLQUFaLENBQWtCLFlBQU07QUFDcEJoRixFQUFBQSxzQkFBc0IsQ0FBQzhCLFVBQXZCO0FBQ0gsQ0FGRCIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBNaWtvUEJYIC0gZnJlZSBwaG9uZSBzeXN0ZW0gZm9yIHNtYWxsIGJ1c2luZXNzXG4gKiBDb3B5cmlnaHQgwqkgMjAxNy0yMDIzIEFsZXhleSBQb3J0bm92IGFuZCBOaWtvbGF5IEJla2V0b3ZcbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeVxuICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnlcbiAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yXG4gKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGVcbiAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uXG4gKiBJZiBub3QsIHNlZSA8aHR0cHM6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LlxuICovXG5cbi8qIGdsb2JhbCBnbG9iYWxSb290VXJsLCBnbG9iYWxUcmFuc2xhdGUsIEZvcm0sIFBieEFwaSovXG5cblxuY29uc3QgbW9kdWxlVXNlcnNVaUluZGV4TGRhcCA9IHtcblxuICAgIC8qKlxuICAgICAqIENoZWNrYm94IGZvciBMREFQIGF1dGhlbnRpY2F0aW9uLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAkdXNlTGRhcENoZWNrYm94OiAkKCcjdXNlLWxkYXAtYXV0aC1tZXRob2QnKSxcblxuICAgIC8qKlxuICAgICAqIFNldCBvZiBmb3JtIGZpZWxkcyB0byB1c2UgZm9yIExEQVAgYXV0aGVudGljYXRpb24uXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgICRmb3JtRmllbGRzRm9yTGRhcFNldHRpbmdzOiAkKCcuZGlzYWJsZS1pZi1uby1sZGFwJyksXG5cbiAgICAvKipcbiAgICAgKiBTZXQgb2YgZWxlbWVudHMgb2YgdGhlIGZvcm0gYWRoZXJlZCB0byBsZGFwIGF1dGggbWV0aG9kLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAkZm9ybUVsZW1lbnRzQXZhaWxhYmxlSWZMZGFwSXNPbjogJCgnLnNob3ctb25seS1pZi1sZGFwLWVuYWJsZWQnKSxcblxuICAgIC8qKlxuICAgICAqIGpRdWVyeSBvYmplY3QgZm9yIHRoZSBsZGFwIGNoZWNrIHNlZ21lbnQuXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkbGRhcENoZWNrU2VnbWVudDogJCgnI2xkYXAtY2hlY2stYXV0aCcpLFxuXG4gICAgLyoqXG4gICAgICogalF1ZXJ5IG9iamVjdCBmb3IgdGhlIGZvcm0uXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkZm9ybU9iajogJCgnI21vZHVsZS11c2Vycy11aS1sZGFwLWZvcm0nKSxcblxuICAgIC8qKlxuICAgICAqIGpRdWVyeSBvYmplY3QgZm9yIHRoZSBjaGVjayBjcmVkZW50aWFscyBidXR0b24uXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkY2hlY2tBdXRoQnV0dG9uOiAkKCcuY2hlY2stbGRhcC1jcmVkZW50aWFscy5idXR0b24nKSxcblxuXG4gICAgLyoqXG4gICAgICogalF1ZXJ5IG9iamVjdCBmb3IgdGhlIGdldHRpbmcgTERBUCB1c2VycyBsaXN0IGJ1dHRvbi5cbiAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAqL1xuICAgICRjaGVja0dldFVzZXJzQnV0dG9uOiAkKCcuY2hlY2stbGRhcC1nZXQtdXNlcnMnKSxcblxuICAgIC8qKlxuICAgICAqIGpRdWVyeSBvYmplY3QgZm9yIHRoZSBsZGFwIGNoZWNrIHNlZ21lbnQuXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkbGRhcENoZWNrR2V0VXNlcnNTZWdtZW50OiAkKCcjbGRhcC1jaGVjay1nZXQtdXNlcnMnKSxcblxuICAgIC8qKlxuICAgICAqIGpRdWVyeSBvYmplY3QgZm9yIHRoZSB1c2UgVExTIHNlbGVjdG9yXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkdXNlVGxzRHJvcGRvd246ICQoJy51c2UtdGxzLWRyb3Bkb3duJyksXG5cbiAgICAvKipcbiAgICAgKiBqUXVlcnkgb2JqZWN0IGZvciB0aGUgc2VydmVyIHR5cGUgZHJvcGRvd24uXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKi9cbiAgICAkbGRhcFR5cGVEcm9wZG93bjogJCgnLnNlbGVjdC1sZGFwLWZpZWxkJyksXG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0aW9uIHJ1bGVzIGZvciB0aGUgZm9ybSBmaWVsZHMuXG4gICAgICogQHR5cGUge09iamVjdH1cbiAgICAgKi9cbiAgICB2YWxpZGF0ZVJ1bGVzOiB7XG4gICAgICAgIHNlcnZlck5hbWU6IHtcbiAgICAgICAgICAgIGlkZW50aWZpZXI6ICdzZXJ2ZXJOYW1lJyxcbiAgICAgICAgICAgIHJ1bGVzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1wdHknLFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5tb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZVNlcnZlck5hbWVJc0VtcHR5LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICBzZXJ2ZXJQb3J0OiB7XG4gICAgICAgICAgICBpZGVudGlmaWVyOiAnc2VydmVyUG9ydCcsXG4gICAgICAgICAgICBydWxlczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2VtcHR5JyxcbiAgICAgICAgICAgICAgICAgICAgcHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubW9kdWxlX3VzZXJzdWlfVmFsaWRhdGVTZXJ2ZXJQb3J0SXNFbXB0eSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgYWRtaW5pc3RyYXRpdmVMb2dpbjoge1xuICAgICAgICAgICAgaWRlbnRpZmllcjogJ2FkbWluaXN0cmF0aXZlTG9naW4nLFxuICAgICAgICAgICAgcnVsZXM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlbXB0eScsXG4gICAgICAgICAgICAgICAgICAgIHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm1vZHVsZV91c2Vyc3VpX1ZhbGlkYXRlQWRtaW5pc3RyYXRpdmVMb2dpbklzRW1wdHksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICAgIGFkbWluaXN0cmF0aXZlUGFzc3dvcmRIaWRkZW46IHtcbiAgICAgICAgICAgIGlkZW50aWZpZXI6ICdhZG1pbmlzdHJhdGl2ZVBhc3N3b3JkSGlkZGVuJyxcbiAgICAgICAgICAgIHJ1bGVzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1wdHknLFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5tb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZUFkbWluaXN0cmF0aXZlUGFzc3dvcmRJc0VtcHR5LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICBiYXNlRE46IHtcbiAgICAgICAgICAgIGlkZW50aWZpZXI6ICdiYXNlRE4nLFxuICAgICAgICAgICAgcnVsZXM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlbXB0eScsXG4gICAgICAgICAgICAgICAgICAgIHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm1vZHVsZV91c2Vyc3VpX1ZhbGlkYXRlQmFzZUROSXNFbXB0eSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgdXNlcklkQXR0cmlidXRlOiB7XG4gICAgICAgICAgICBpZGVudGlmaWVyOiAndXNlcklkQXR0cmlidXRlJyxcbiAgICAgICAgICAgIHJ1bGVzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1wdHknLFxuICAgICAgICAgICAgICAgICAgICBwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5tb2R1bGVfdXNlcnN1aV9WYWxpZGF0ZVVzZXJJZEF0dHJpYnV0ZUlzRW1wdHksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRoZSBtb2R1bGUuXG4gICAgICovXG4gICAgaW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC5pbml0aWFsaXplRm9ybSgpO1xuXG4gICAgICAgIC8vIEhhbmRsZSBnZXQgdXNlcnMgbGlzdCBidXR0b24gY2xpY2tcbiAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kY2hlY2tHZXRVc2Vyc0J1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC5hcGlDYWxsR2V0TGRhcFVzZXJzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEhhbmRsZSBjaGVjayBidXR0b24gY2xpY2tcbiAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kY2hlY2tBdXRoQnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLmFwaUNhbGxDaGVja0F1dGgoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gR2VuZXJhbCBsZGFwIHN3aXRjaGVyXG4gICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJHVzZUxkYXBDaGVja2JveC5jaGVja2JveCh7XG4gICAgICAgICAgICBvbkNoYW5nZTogbW9kdWxlVXNlcnNVaUluZGV4TGRhcC5vbkNoYW5nZUxkYXBDaGVja2JveCxcbiAgICAgICAgfSk7XG4gICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAub25DaGFuZ2VMZGFwQ2hlY2tib3goKTtcblxuICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRsZGFwVHlwZURyb3Bkb3duLmRyb3Bkb3duKHtcbiAgICAgICAgICAgIG9uQ2hhbmdlOiBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLm9uQ2hhbmdlTGRhcFR5cGUsXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBIYW5kbGUgY2hhbmdlIFRMUyBwcm90b2NvbFxuICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiR1c2VUbHNEcm9wZG93bi5kcm9wZG93bih7XG4gICAgICAgICAgICB2YWx1ZXM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdsZGFwOi8vJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICcwJyxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnZ2V0IHZhbHVlJywgJ3VzZVRMUycpID09PSAnMCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2xkYXBzOi8vJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICcxJyxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnZ2V0IHZhbHVlJywgJ3VzZVRMUycpID09PSAnMSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdLFxuICAgICAgICB9KTtcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgY2hhbmdlIExEQVAgZHJvcGRvd24uXG4gICAgICovXG4gICAgb25DaGFuZ2VMZGFwVHlwZSh2YWx1ZSl7XG4gICAgICAgIGlmKHZhbHVlPT09J09wZW5MREFQJyl7XG4gICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtT2JqLmZvcm0oJ3NldCB2YWx1ZScsJ3VzZXJJZEF0dHJpYnV0ZScsJ3VpZCcpO1xuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iai5mb3JtKCdzZXQgdmFsdWUnLCdhZG1pbmlzdHJhdGl2ZUxvZ2luJywnY249YWRtaW4sZGM9ZXhhbXBsZSxkYz1jb20nKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywndXNlckZpbHRlcicsJyhvYmplY3RDbGFzcz1pbmV0T3JnUGVyc29uKScpO1xuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iai5mb3JtKCdzZXQgdmFsdWUnLCdiYXNlRE4nLCdkYz1leGFtcGxlLGRjPWNvbScpO1xuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iai5mb3JtKCdzZXQgdmFsdWUnLCdvcmdhbml6YXRpb25hbFVuaXQnLCdvdT11c2VycywgZGM9ZG9tYWluLCBkYz1jb20nKTtcbiAgICAgICAgfSBlbHNlIGlmKHZhbHVlPT09J0FjdGl2ZURpcmVjdG9yeScpe1xuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iai5mb3JtKCdzZXQgdmFsdWUnLCdhZG1pbmlzdHJhdGl2ZUxvZ2luJywnYWRtaW4nKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywndXNlcklkQXR0cmlidXRlJywnc2FtYWNjb3VudG5hbWUnKVxuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iai5mb3JtKCdzZXQgdmFsdWUnLCd1c2VyRmlsdGVyJywnKCYob2JqZWN0Q2xhc3M9dXNlcikob2JqZWN0Q2F0ZWdvcnk9UEVSU09OKSknKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywnYmFzZUROJywnZGM9ZXhhbXBsZSxkYz1jb20nKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywnb3JnYW5pemF0aW9uYWxVbml0Jywnb3U9dXNlcnMsIGRjPWRvbWFpbiwgZGM9Y29tJyk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgZ2V0IExEQVAgdXNlcnMgbGlzdCBidXR0b24gY2xpY2suXG4gICAgICovXG4gICAgYXBpQ2FsbEdldExkYXBVc2Vycygpe1xuICAgICAgICAkLmFwaSh7XG4gICAgICAgICAgICB1cmw6IGAke2dsb2JhbFJvb3RVcmx9bW9kdWxlLXVzZXJzLXUtaS9sZGFwLWNvbmZpZy9nZXQtYXZhaWxhYmxlLWxkYXAtdXNlcnNgLFxuICAgICAgICAgICAgb246ICdub3cnLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBiZWZvcmVTZW5kKHNldHRpbmdzKSB7XG4gICAgICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kY2hlY2tHZXRVc2Vyc0J1dHRvbi5hZGRDbGFzcygnbG9hZGluZyBkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIHNldHRpbmdzLmRhdGEgPSBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtT2JqLmZvcm0oJ2dldCB2YWx1ZXMnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2V0dGluZ3M7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3VjY2Vzc1Rlc3QocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5zdWNjZXNzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSGFuZGxlcyB0aGUgc3VjY2Vzc2Z1bCByZXNwb25zZSBvZiB0aGUgJ2dldC1hdmFpbGFibGUtbGRhcC11c2VycycgQVBJIHJlcXVlc3QuXG4gICAgICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gcmVzcG9uc2UgLSBUaGUgcmVzcG9uc2Ugb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvblN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGNoZWNrR2V0VXNlcnNCdXR0b24ucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcgZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICAkKCcudWkubWVzc2FnZS5hamF4JykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgbGV0IGh0bWwgPSAnPHVsIGNsYXNzPVwidWkgbGlzdFwiPic7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gYDxsaSBjbGFzcz1cIml0ZW1cIj4ke2dsb2JhbHRyYW5zbGF0ZS5tb2R1bGVfdXNlcnN1aV9FbXB0eVNlcnZlclJlc3BvbnNlfTwvbGk+YDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkLmVhY2gocmVzcG9uc2UuZGF0YSwgKGluZGV4LCB1c2VyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IGA8bGkgY2xhc3M9XCJpdGVtXCI+JHt1c2VyLm5hbWV9ICgke3VzZXIubG9naW59KTwvbGk+YDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvdWw+JztcbiAgICAgICAgICAgICAgICBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRsZGFwQ2hlY2tHZXRVc2Vyc1NlZ21lbnQuYWZ0ZXIoYDxkaXYgY2xhc3M9XCJ1aSBpY29uIG1lc3NhZ2UgYWpheCBwb3NpdGl2ZVwiPiR7aHRtbH08L2Rpdj5gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEhhbmRsZXMgdGhlIGZhaWx1cmUgcmVzcG9uc2Ugb2YgdGhlICdnZXQtYXZhaWxhYmxlLWxkYXAtdXNlcnMnIEFQSSByZXF1ZXN0LlxuICAgICAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IHJlc3BvbnNlIC0gVGhlIHJlc3BvbnNlIG9iamVjdC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb25GYWlsdXJlOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGNoZWNrR2V0VXNlcnNCdXR0b24ucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcgZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICAkKCcudWkubWVzc2FnZS5hamF4JykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kbGRhcENoZWNrR2V0VXNlcnNTZWdtZW50LmFmdGVyKGA8ZGl2IGNsYXNzPVwidWkgaWNvbiBtZXNzYWdlIGFqYXggbmVnYXRpdmVcIj48aSBjbGFzcz1cImljb24gZXhjbGFtYXRpb24gY2lyY2xlXCI+PC9pPiR7cmVzcG9uc2UubWVzc2FnZX08L2Rpdj5gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgY2hlY2sgTERBUCBhdXRoZW50aWNhdGlvbiBidXR0b24gY2xpY2suXG4gICAgICovXG4gICAgYXBpQ2FsbENoZWNrQXV0aCgpe1xuICAgICAgICAkLmFwaSh7XG4gICAgICAgICAgICB1cmw6IGAke2dsb2JhbFJvb3RVcmx9bW9kdWxlLXVzZXJzLXUtaS9sZGFwLWNvbmZpZy9jaGVjay1hdXRoYCxcbiAgICAgICAgICAgIG9uOiAnbm93JyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYmVmb3JlU2VuZChzZXR0aW5ncykge1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGNoZWNrQXV0aEJ1dHRvbi5hZGRDbGFzcygnbG9hZGluZyBkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIHNldHRpbmdzLmRhdGEgPSBtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiRmb3JtT2JqLmZvcm0oJ2dldCB2YWx1ZXMnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2V0dGluZ3M7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3VjY2Vzc1Rlc3QocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5zdWNjZXNzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSGFuZGxlcyB0aGUgc3VjY2Vzc2Z1bCByZXNwb25zZSBvZiB0aGUgJ2NoZWNrLWxkYXAtYXV0aCcgQVBJIHJlcXVlc3QuXG4gICAgICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gcmVzcG9uc2UgLSBUaGUgcmVzcG9uc2Ugb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvblN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kY2hlY2tBdXRoQnV0dG9uLnJlbW92ZUNsYXNzKCdsb2FkaW5nIGRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgJCgnLnVpLm1lc3NhZ2UuYWpheCcpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGxkYXBDaGVja1NlZ21lbnQuYWZ0ZXIoYDxkaXYgY2xhc3M9XCJ1aSBpY29uIG1lc3NhZ2UgYWpheCBwb3NpdGl2ZVwiPjxpIGNsYXNzPVwiaWNvbiBjaGVja1wiPjwvaT4gJHtyZXNwb25zZS5tZXNzYWdlfTwvZGl2PmApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogSGFuZGxlcyB0aGUgZmFpbHVyZSByZXNwb25zZSBvZiB0aGUgJ2NoZWNrLWxkYXAtYXV0aCcgQVBJIHJlcXVlc3QuXG4gICAgICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gcmVzcG9uc2UgLSBUaGUgcmVzcG9uc2Ugb2JqZWN0LlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBvbkZhaWx1cmU6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kY2hlY2tBdXRoQnV0dG9uLnJlbW92ZUNsYXNzKCdsb2FkaW5nIGRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgJCgnLnVpLm1lc3NhZ2UuYWpheCcpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGxkYXBDaGVja1NlZ21lbnQuYWZ0ZXIoYDxkaXYgY2xhc3M9XCJ1aSBpY29uIG1lc3NhZ2UgYWpheCBuZWdhdGl2ZVwiPjxpIGNsYXNzPVwiaWNvbiBleGNsYW1hdGlvbiBjaXJjbGVcIj48L2k+JHtyZXNwb25zZS5tZXNzYWdlfTwvZGl2PmApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlcyB0aGUgY2hhbmdlIG9mIHRoZSBMREFQIGNoZWNrYm94LlxuICAgICAqL1xuICAgIG9uQ2hhbmdlTGRhcENoZWNrYm94KCl7XG4gICAgICAgIGlmIChtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiR1c2VMZGFwQ2hlY2tib3guY2hlY2tib3goJ2lzIGNoZWNrZWQnKSkge1xuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybUZpZWxkc0ZvckxkYXBTZXR0aW5ncy5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1FbGVtZW50c0F2YWlsYWJsZUlmTGRhcElzT24uc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybUZpZWxkc0ZvckxkYXBTZXR0aW5ncy5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuJGZvcm1FbGVtZW50c0F2YWlsYWJsZUlmTGRhcElzT24uaGlkZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIENhbGxiYWNrIGZ1bmN0aW9uIGJlZm9yZSBzZW5kaW5nIHRoZSBmb3JtLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBzZXR0aW5ncyAtIFRoZSBzZXR0aW5ncyBvYmplY3QuXG4gICAgICogQHJldHVybnMge29iamVjdH0gLSBUaGUgbW9kaWZpZWQgc2V0dGluZ3Mgb2JqZWN0LlxuICAgICAqL1xuICAgIGNiQmVmb3JlU2VuZEZvcm0oc2V0dGluZ3MpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gc2V0dGluZ3M7XG4gICAgICAgIHJlc3VsdC5kYXRhID0gbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iai5mb3JtKCdnZXQgdmFsdWVzJyk7XG4gICAgICAgIGlmIChtb2R1bGVVc2Vyc1VpSW5kZXhMZGFwLiR1c2VMZGFwQ2hlY2tib3guY2hlY2tib3goJ2lzIGNoZWNrZWQnKSl7XG4gICAgICAgICAgICByZXN1bHQuZGF0YS51c2VMZGFwQXV0aE1ldGhvZCA9ICcxJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdC5kYXRhLnVzZUxkYXBBdXRoTWV0aG9kID0gJzAnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgZnVuY3Rpb24gYWZ0ZXIgc2VuZGluZyB0aGUgZm9ybS5cbiAgICAgKi9cbiAgICBjYkFmdGVyU2VuZEZvcm0oKSB7XG4gICAgICAgIC8vIENhbGxiYWNrIGltcGxlbWVudGF0aW9uXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRoZSBmb3JtLlxuICAgICAqL1xuICAgIGluaXRpYWxpemVGb3JtKCkge1xuICAgICAgICBGb3JtLiRmb3JtT2JqID0gbW9kdWxlVXNlcnNVaUluZGV4TGRhcC4kZm9ybU9iajtcbiAgICAgICAgRm9ybS51cmwgPSBgJHtnbG9iYWxSb290VXJsfW1vZHVsZS11c2Vycy11LWkvbGRhcC1jb25maWcvc2F2ZWA7XG4gICAgICAgIEZvcm0udmFsaWRhdGVSdWxlcyA9IG1vZHVsZVVzZXJzVWlJbmRleExkYXAudmFsaWRhdGVSdWxlcztcbiAgICAgICAgRm9ybS5jYkJlZm9yZVNlbmRGb3JtID0gbW9kdWxlVXNlcnNVaUluZGV4TGRhcC5jYkJlZm9yZVNlbmRGb3JtO1xuICAgICAgICBGb3JtLmNiQWZ0ZXJTZW5kRm9ybSA9IG1vZHVsZVVzZXJzVWlJbmRleExkYXAuY2JBZnRlclNlbmRGb3JtO1xuICAgICAgICBGb3JtLmluaXRpYWxpemUoKTtcbiAgICB9LFxufTtcblxuJChkb2N1bWVudCkucmVhZHkoKCkgPT4ge1xuICAgIG1vZHVsZVVzZXJzVWlJbmRleExkYXAuaW5pdGlhbGl6ZSgpO1xufSk7XG4iXX0=