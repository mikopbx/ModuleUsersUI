"use strict";

/*
 * MikoPBX - free phone system for small business
 * Copyright Â© 2017-2023 Alexey Portnov and Nikolay Beketov
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see <https://www.gnu.org/licenses/>.
 */

/** global: globalRootUrl */

/**
 * ExtensionCredentialsTab module for managing extension credentials tab.
 * @module ExtensionCredentialsTab
 */
var ExtensionCredentialsTab = {
  /**
   * Hidden field for LDAP enabled status.
   * @type {jQuery}
   * @private
   */
  $ldapEnabledHiddenField: $('#module_users_ui_ldap_enabled'),

  /**
   * Checkbox for LDAP authentication.
   * @type {jQuery}
   * @private
   */
  $useLdapCheckbox: $('#module_users_ui_use_ldap_auth'),

  /**
   * Login input field.
   * @type {jQuery}
   * @private
   */
  $loginField: $('#module_users_ui_login'),

  /**
   * Password input field.
   * @type {jQuery}
   * @private
   */
  $passwordField: $('#module_users_ui_password'),

  /**
   * Access group dropdown.
   * @type {jQuery}
   * @private
   */
  $accessGroupDropdown: $('#module_users_ui_access_group'),

  /**
   * Fields, which we need to disable if selected access group is 'No access'.
   * @type {jQuery}
   * @private
   */
  $disableIfNoAccess: $('.disable-if-no-access'),

  /**
   * Initializes the ExtensionCredentialsTab module.
   */
  initialize: function initialize() {
    ExtensionCredentialsTab.showHideAuthFields();
    ExtensionCredentialsTab.showHideUseLdapCheckbox();
    ExtensionCredentialsTab.showHidePasswordInput();
    ExtensionCredentialsTab.$useLdapCheckbox.parent('.checkbox').checkbox({
      onChange: ExtensionCredentialsTab.showHidePasswordInput
    });
    ExtensionCredentialsTab.$accessGroupDropdown.parent('.dropdown').dropdown({
      onChange: ExtensionCredentialsTab.showHideAuthFields
    });
  },

  /**
   * Shows or hides the authentication fields based on the selected access group.
   */
  showHideAuthFields: function showHideAuthFields() {
    if (ExtensionCredentialsTab.$accessGroupDropdown.val() === 'No access') {
      ExtensionCredentialsTab.$disableIfNoAccess.addClass('disabled');
    } else {
      ExtensionCredentialsTab.$disableIfNoAccess.removeClass('disabled');
    }
  },

  /**
   * Shows or hides the LDAP checkbox based on the LDAP enabled status.
   */
  showHideUseLdapCheckbox: function showHideUseLdapCheckbox() {
    if (ExtensionCredentialsTab.$ldapEnabledHiddenField.val() === '1') {
      ExtensionCredentialsTab.$useLdapCheckbox.parent('.field').show();
    } else {
      ExtensionCredentialsTab.$useLdapCheckbox.parent('.field').hide();
      ExtensionCredentialsTab.$useLdapCheckbox.parent('.checkbox').checkbox('set unchecked');
    }
  },

  /**
   * Shows or hides the password input based on the LDAP checkbox status.
   */
  showHidePasswordInput: function showHidePasswordInput() {
    if (ExtensionCredentialsTab.$useLdapCheckbox.parent('.checkbox').checkbox('is checked')) {
      ExtensionCredentialsTab.$passwordField.parent('.field').hide();
    } else {
      ExtensionCredentialsTab.$passwordField.parent('.field').show();
    }

    ExtensionCredentialsTab.activateLdapLoginSearch();
  },

  /**
   * Activate or disactivate ldap search feature
   */
  activateLdapLoginSearch: function activateLdapLoginSearch() {
    if (ExtensionCredentialsTab.$useLdapCheckbox.parent('.checkbox').checkbox('is checked')) {
      ExtensionCredentialsTab.$loginField.parent('.ui.search').search({
        apiSettings: {
          url: "".concat(globalRootUrl, "module-users-u-i/ldap-config/search-ldap-user/{query}")
        }
      });
    } else {
      ExtensionCredentialsTab.$loginField.parent('.ui.search').search('hide results').search('destroy');
    }
  }
};
$(document).ready(function () {
  ExtensionCredentialsTab.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb2R1bGUtdXNlcnMtdWktZXh0ZW5zaW9ucy1tb2RpZnkuanMiXSwibmFtZXMiOlsiRXh0ZW5zaW9uQ3JlZGVudGlhbHNUYWIiLCIkbGRhcEVuYWJsZWRIaWRkZW5GaWVsZCIsIiQiLCIkdXNlTGRhcENoZWNrYm94IiwiJGxvZ2luRmllbGQiLCIkcGFzc3dvcmRGaWVsZCIsIiRhY2Nlc3NHcm91cERyb3Bkb3duIiwiJGRpc2FibGVJZk5vQWNjZXNzIiwiaW5pdGlhbGl6ZSIsInNob3dIaWRlQXV0aEZpZWxkcyIsInNob3dIaWRlVXNlTGRhcENoZWNrYm94Iiwic2hvd0hpZGVQYXNzd29yZElucHV0IiwicGFyZW50IiwiY2hlY2tib3giLCJvbkNoYW5nZSIsImRyb3Bkb3duIiwidmFsIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsInNob3ciLCJoaWRlIiwiYWN0aXZhdGVMZGFwTG9naW5TZWFyY2giLCJzZWFyY2giLCJhcGlTZXR0aW5ncyIsInVybCIsImdsb2JhbFJvb3RVcmwiLCJkb2N1bWVudCIsInJlYWR5Il0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFNQSx1QkFBdUIsR0FBRztBQUM1QjtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0lDLEVBQUFBLHVCQUF1QixFQUFFQyxDQUFDLENBQUMsK0JBQUQsQ0FORTs7QUFRNUI7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNJQyxFQUFBQSxnQkFBZ0IsRUFBRUQsQ0FBQyxDQUFDLGdDQUFELENBYlM7O0FBZTVCO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDSUUsRUFBQUEsV0FBVyxFQUFFRixDQUFDLENBQUMsd0JBQUQsQ0FwQmM7O0FBc0I1QjtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0lHLEVBQUFBLGNBQWMs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LFVBQUFBLEdBQUcsWUFBS0MsYUFBTDtBQURNO0FBRCtDLE9BQWhFO0FBS0gsS0FORCxNQU1PO0FBQ0h6QixNQUFBQSx1QkFBdUIsQ0FBQ0ksV0FBeEIsQ0FBb0NRLE1BQXBDLENBQTJDLFlBQTNDLEVBQXlEVSxNQUF6RCxDQUFnRSxjQUFoRSxFQUFnRkEsTUFBaEYsQ0FBdUYsU0FBdkY7QUFDSDtBQUVKO0FBMUcyQixDQUFoQztBQTRHQXBCLENBQUMsQ0FBQ3dCLFFBQUQsQ0FBRCxDQUFZQyxLQUFaLENBQWtCLFlBQU07QUFDcEIzQixFQUFBQSx1QkFBdUIsQ0FBQ1EsVUFBeEI7QUFDSCxDQUZEIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIE1pa29QQlggLSBmcmVlIHBob25lIHN5c3RlbSBmb3Igc21hbGwgYnVzaW5lc3NcbiAqIENvcHlyaWdodCDCqSAyMDE3LTIwMjMgQWxleGV5IFBvcnRub3YgYW5kIE5pa29sYXkgQmVrZXRvdlxuICpcbiAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxuICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3JcbiAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZVxuICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS5cbiAqIElmIG5vdCwgc2VlIDxodHRwczovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uXG4gKi9cblxuLyoqIGdsb2JhbDogZ2xvYmFsUm9vdFVybCAqL1xuXG4vKipcbiAqIEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiIG1vZHVsZSBmb3IgbWFuYWdpbmcgZXh0ZW5zaW9uIGNyZWRlbnRpYWxzIHRhYi5cbiAqIEBtb2R1bGUgRXh0ZW5zaW9uQ3JlZGVudGlhbHNUYWJcbiAqL1xuY29uc3QgRXh0ZW5zaW9uQ3JlZGVudGlhbHNUYWIgPSB7XG4gICAgLyoqXG4gICAgICogSGlkZGVuIGZpZWxkIGZvciBMREFQIGVuYWJsZWQgc3RhdHVzLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAkbGRhcEVuYWJsZWRIaWRkZW5GaWVsZDogJCgnI21vZHVsZV91c2Vyc191aV9sZGFwX2VuYWJsZWQnKSxcblxuICAgIC8qKlxuICAgICAqIENoZWNrYm94IGZvciBMREFQIGF1dGhlbnRpY2F0aW9uLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAkdXNlTGRhcENoZWNrYm94OiAkKCcjbW9kdWxlX3VzZXJzX3VpX3VzZV9sZGFwX2F1dGgnKSxcblxuICAgIC8qKlxuICAgICAqIExvZ2luIGlucHV0IGZpZWxkLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAkbG9naW5GaWVsZDogJCgnI21vZHVsZV91c2Vyc191aV9sb2dpbicpLFxuXG4gICAgLyoqXG4gICAgICogUGFzc3dvcmQgaW5wdXQgZmllbGQuXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgICRwYXNzd29yZEZpZWxkOiAkKCcjbW9kdWxlX3VzZXJzX3VpX3Bhc3N3b3JkJyksXG5cbiAgICAvKipcbiAgICAgKiBBY2Nlc3MgZ3JvdXAgZHJvcGRvd24uXG4gICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgICRhY2Nlc3NHcm91cERyb3Bkb3duOiAkKCcjbW9kdWxlX3VzZXJzX3VpX2FjY2Vzc19ncm91cCcpLFxuXG4gICAgLyoqXG4gICAgICogRmllbGRzLCB3aGljaCB3ZSBuZWVkIHRvIGRpc2FibGUgaWYgc2VsZWN0ZWQgYWNjZXNzIGdyb3VwIGlzICdObyBhY2Nlc3MnLlxuICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAkZGlzYWJsZUlmTm9BY2Nlc3M6ICQoJy5kaXNhYmxlLWlmLW5vLWFjY2VzcycpLFxuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgdGhlIEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiIG1vZHVsZS5cbiAgICAgKi9cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiLnNob3dIaWRlQXV0aEZpZWxkcygpO1xuICAgICAgICBFeHRlbnNpb25DcmVkZW50aWFsc1RhYi5zaG93SGlkZVVzZUxkYXBDaGVja2JveCgpO1xuICAgICAgICBFeHRlbnNpb25DcmVkZW50aWFsc1RhYi5zaG93SGlkZVBhc3N3b3JkSW5wdXQoKTtcbiAgICAgICAgRXh0ZW5zaW9uQ3JlZGVudGlhbHNUYWIuJHVzZUxkYXBDaGVja2JveC5wYXJlbnQoJy5jaGVja2JveCcpLmNoZWNrYm94KHtcbiAgICAgICAgICAgIG9uQ2hhbmdlOiBFeHRlbnNpb25DcmVkZW50aWFsc1RhYi5zaG93SGlkZVBhc3N3b3JkSW5wdXQsXG4gICAgICAgIH0pO1xuICAgICAgICBFeHRlbnNpb25DcmVkZW50aWFsc1RhYi4kYWNjZXNzR3JvdXBEcm9wZG93bi5wYXJlbnQoJy5kcm9wZG93bicpLmRyb3Bkb3duKHtcbiAgICAgICAgICAgIG9uQ2hhbmdlOiBFeHRlbnNpb25DcmVkZW50aWFsc1RhYi5zaG93SGlkZUF1dGhGaWVsZHMsXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTaG93cyBvciBoaWRlcyB0aGUgYXV0aGVudGljYXRpb24gZmllbGRzIGJhc2VkIG9uIHRoZSBzZWxlY3RlZCBhY2Nlc3MgZ3JvdXAuXG4gICAgICovXG4gICAgc2hvd0hpZGVBdXRoRmllbGRzKCl7XG4gICAgICAgIGlmIChFeHRlbnNpb25DcmVkZW50aWFsc1RhYi4kYWNjZXNzR3JvdXBEcm9wZG93bi52YWwoKSA9PT0gJ05vIGFjY2Vzcycpe1xuICAgICAgICAgICAgRXh0ZW5zaW9uQ3JlZGVudGlhbHNUYWIuJGRpc2FibGVJZk5vQWNjZXNzLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgRXh0ZW5zaW9uQ3JlZGVudGlhbHNUYWIuJGRpc2FibGVJZk5vQWNjZXNzLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNob3dzIG9yIGhpZGVzIHRoZSBMREFQIGNoZWNrYm94IGJhc2VkIG9uIHRoZSBMREFQIGVuYWJsZWQgc3RhdHVzLlxuICAgICAqL1xuICAgIHNob3dIaWRlVXNlTGRhcENoZWNrYm94OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChFeHRlbnNpb25DcmVkZW50aWFsc1RhYi4kbGRhcEVuYWJsZWRIaWRkZW5GaWVsZC52YWwoKSA9PT0gJzEnKSB7XG4gICAgICAgICAgICBFeHRlbnNpb25DcmVkZW50aWFsc1RhYi4kdXNlTGRhcENoZWNrYm94LnBhcmVudCgnLmZpZWxkJykuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgRXh0ZW5zaW9uQ3JlZGVudGlhbHNUYWIuJHVzZUxkYXBDaGVja2JveC5wYXJlbnQoJy5maWVsZCcpLmhpZGUoKTtcbiAgICAgICAgICAgIEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiLiR1c2VMZGFwQ2hlY2tib3gucGFyZW50KCcuY2hlY2tib3gnKS5jaGVja2JveCgnc2V0IHVuY2hlY2tlZCcpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNob3dzIG9yIGhpZGVzIHRoZSBwYXNzd29yZCBpbnB1dCBiYXNlZCBvbiB0aGUgTERBUCBjaGVja2JveCBzdGF0dXMuXG4gICAgICovXG4gICAgc2hvd0hpZGVQYXNzd29yZElucHV0OiBmdW5jdGlvbiAoKXtcbiAgICAgICAgaWYgKEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiLiR1c2VMZGFwQ2hlY2tib3gucGFyZW50KCcuY2hlY2tib3gnKS5jaGVja2JveCgnaXMgY2hlY2tlZCcpKSB7XG4gICAgICAgICAgICBFeHRlbnNpb25DcmVkZW50aWFsc1RhYi4kcGFzc3dvcmRGaWVsZC5wYXJlbnQoJy5maWVsZCcpLmhpZGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiLiRwYXNzd29yZEZpZWxkLnBhcmVudCgnLmZpZWxkJykuc2hvdygpO1xuICAgICAgICB9XG4gICAgICAgIEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiLmFjdGl2YXRlTGRhcExvZ2luU2VhcmNoKCk7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBBY3RpdmF0ZSBvciBkaXNhY3RpdmF0ZSBsZGFwIHNlYXJjaCBmZWF0dXJlXG4gICAgICovXG4gICAgYWN0aXZhdGVMZGFwTG9naW5TZWFyY2goKXtcbiAgICAgICAgaWYgKEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiLiR1c2VMZGFwQ2hlY2tib3gucGFyZW50KCcuY2hlY2tib3gnKS5jaGVja2JveCgnaXMgY2hlY2tlZCcpKXtcbiAgICAgICAgICAgIEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiLiRsb2dpbkZpZWxkLnBhcmVudCgnLnVpLnNlYXJjaCcpLnNlYXJjaCh7XG4gICAgICAgICAgICAgICAgYXBpU2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBgJHtnbG9iYWxSb290VXJsfW1vZHVsZS11c2Vycy11LWkvbGRhcC1jb25maWcvc2VhcmNoLWxkYXAtdXNlci97cXVlcnl9YFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIEV4dGVuc2lvbkNyZWRlbnRpYWxzVGFiLiRsb2dpbkZpZWxkLnBhcmVudCgnLnVpLnNlYXJjaCcpLnNlYXJjaCgnaGlkZSByZXN1bHRzJykuc2VhcmNoKCdkZXN0cm95Jyk7XG4gICAgICAgIH1cblxuICAgIH0sXG59XG4kKGRvY3VtZW50KS5yZWFkeSgoKSA9PiB7XG4gICAgRXh0ZW5zaW9uQ3JlZGVudGlhbHNUYWIuaW5pdGlhbGl6ZSgpO1xufSk7XG4iXX0=